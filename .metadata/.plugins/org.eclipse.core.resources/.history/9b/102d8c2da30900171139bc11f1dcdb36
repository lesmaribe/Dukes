/**
 * @author LESETJA
 * @email lesmaribe@gmail.com
 */

var catalogueModule = angular.module('dukes.bookcataloguemodule', []);
console.log('book catalogue module loaded...')


catalogueModule.factory('bookFactory', ['$http', function($http){
	var bookFactory = {};
	
	bookFactory.getBooks = function(){
		return $http.get($rootScope.urlBase + 'books');
	};
	
	bookFactory.getBook = function(id){
		return $http.get($rootScope.urlBase + id);
	};
	
	bookFactory.createBook = function(book){
		return $http.post($rootScope.urlBase, book);
	};
	
	bookFactory.updateBook = function(book){
		return $http.put($rootScope.urlBase, book);
	};
	
	return bookFactory;
}]);


catalogueModule.controller('BookCatalogueCtrl', ['$scope', '$location', '$rootScope', 'bookFactory', function($scope, $location, $rootScope, bookFactory){
	var books = [{'id': 1000, 'author_name': 'Lesetja', 'author_surname': 'Maribe', 'author_title': 'Mr', 'title': 'How to Program', 'price': 100.00, 'onSale': true, 'year': 2017, 
		'description': 'How to program in java se 7 and java ee 7, using jee container jboss eap 6. for front end suit your self, use whatever you like.', 'copies': 10},
		{'id': 1001, 'author_name': 'Lesetja', 'author_surname': 'Maribe', 'author_title': 'Mr', 'title': 'How to Program', 'price': 100.00, 'onSale': true, 'year': 2017, 
			'description': 'How to program in java se 7 and java ee 7, using jee container jboss eap 6. for front end suit your self, use whatever you like.', 'copies': 10},
			{'id': 1002, 'author_name': 'Lesetja', 'author_surname': 'Maribe', 'author_title': 'Mr', 'title': 'How to Program', 'price': 100.00, 'onSale': true, 'year': 2017, 
				'description': 'How to program in java se 7 and java ee 7, using jee container jboss eap 6. for front end suit your self, use whatever you like.', 'copies': 10},
				{'id': 1003, 'author_name': 'Lesetja', 'author_surname': 'Maribe', 'author_title': 'Mr', 'title': 'How to Program', 'price': 100.00, 'onSale': true, 'year': 2017, 
					'description': 'How to program in java se 7 and java ee 7, using jee container jboss eap 6. for front end suit your self, use whatever you like.', 'copies': 10},
					{'id': 1004, 'author_name': 'Lesetja', 'author_surname': 'Maribe', 'author_title': 'Mr', 'title': 'How to Program', 'price': 100.00, 'onSale': true, 'year': 2017, 
						'description': 'How to program in java se 7 and java ee 7, using jee container jboss eap 6. for front end suit your self, use whatever you like.', 'copies': 10}
	             ];
	
	function getBooks(){
		bookFactory.getBooks().then(function(response){
			console.log(response.data);
			books = response.data;
		}, function(error){
			console.log(error.message);
		});
	}
	
	$scope.books = books;
	
	$scope.addtocart = function(book){
		$rootScope.cart.push(book);
		console.log($rootScope.cart);
	};
	
	$scope.purchase = function(){
		$location.path('/purchase');
	};
	
	$scope.emptyCart = function(){
		$rootScope.cart = [];
	};
}]);